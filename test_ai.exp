#!/usr/bin/expect -f

# Test OCLI AI functionality with longer timeout
set timeout 120

puts "Testing OCLI AI functionality..."

# Start OCLI
spawn ocli

# Wait for the prompt
expect "You: " {
    puts "âœ… OCLI started successfully"
} timeout {
    puts "âŒ OCLI failed to start"
    exit 1
}

# Send a simple test question
send "Say hello\r"

# Wait for AI response to start
expect "AI: " {
    puts "âœ… AI prompt appeared"
} timeout {
    puts "âŒ AI prompt didn't appear"
    exit 1
}

# Wait for some response content (look for common words)
expect {
    "Hello" {
        puts "âœ… Got AI response!"
        exp_continue
    }
    "hello" {
        puts "âœ… Got AI response!"
        exp_continue
    }
    "Hi" {
        puts "âœ… Got AI response!"
        exp_continue
    }
    "You: " {
        puts "âœ… AI response completed, back to prompt"
    }
    timeout {
        puts "âŒ Timeout waiting for AI response"
        exit 1
    }
}

# Test exit
send "exit\r"
expect "Goodbye! ğŸ‘‹"
expect eof

puts "ğŸ‰ AI functionality test passed!"
