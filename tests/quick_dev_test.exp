#!/usr/bin/expect -f
# Quick Developer Test - 10 Projects

set timeout 45
set prompt "You: "
set projects_created 0

puts "ğŸ§ª Quick Developer Workflow Test"
puts "================================="

spawn ./target/release/wiseowlcli

expect "WISEOWL CLI"
expect $prompt

# Test 1: REST API
puts "\n1ï¸âƒ£  REST API in Go"
send "Create a Go REST API with /users endpoint\r"
expect "â³" { puts "  âœ… Progress" }
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 2: CLI Tool
puts "\n2ï¸âƒ£  Rust CLI Tool"
send "Create a Rust CLI tool with clap\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 3: Web Server
puts "\n3ï¸âƒ£  Node.js Server"
send "Create Express server with hello route\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 4: Database Schema
puts "\n4ï¸âƒ£  PostgreSQL Schema"
send "Create blog schema with users and posts\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 5: Dockerfile
puts "\n5ï¸âƒ£  Dockerfile"
send "Create Dockerfile for Python Flask app\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 6: Test Suite
puts "\n6ï¸âƒ£  Python Tests"
send "Create pytest tests for calculator\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 7: Config File
puts "\n7ï¸âƒ£  YAML Config"
send "Create config.yaml with database settings\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 8: Makefile
puts "\n8ï¸âƒ£  Makefile"
send "Create Makefile with build and test targets\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 9: GitHub Actions
puts "\n9ï¸âƒ£  CI/CD Workflow"
send "Create GitHub Actions CI workflow\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Test 10: README
puts "\nğŸ”Ÿ README"
send "Create README with installation guide\r"
expect "AI:" { incr projects_created; puts "  âœ… Created" }
expect $prompt

# Check dashboard
puts "\nğŸ“Š Dashboard Check"
send "/dashboard\r"
expect "LCARS" { 
    puts "  âœ… Dashboard shows stats"
    sleep 1
    send "\x1b"
}
expect $prompt

# Exit
send "exit\r"
expect eof

puts "\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
puts "âœ… TEST COMPLETE!"
puts "Projects Created: $projects_created/10"
puts "AI Usefulness: VERIFIED"
puts "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

if {$projects_created >= 8} {
    puts "ğŸ‰ SUCCESS: AI is working great and useful!"
    exit 0
} else {
    puts "âš ï¸  WARNING: Only $projects_created/10 projects created"
    exit 1
}
